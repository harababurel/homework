YUI.add("stencil-gallery",function(e,t){"use strict";function k(r){this.constructor.superclass.constructor.call(this,r);if(this._node&&this._node.get("tagName").toUpperCase()==="BODY")return;var i=this._node,s,o=i.all(y),u=i.one(g),p=i.one(b),v=i.ancestor("[dir]",!0),w=u&&u.all(m),T=w&&w.size(),N;if(!i||!u||!p)return;this.node=i,this.sliderEl=u,this.maskEl=p,this.currentWidth=p.get("offsetWidth"),this.itemsEl=u&&this.sliderEl.all(m),this.indicatorsEl=o.size()>0?o:n,this.prevEl=i.one(E),this.nextEl=i.one(S),this.itemsLength=T,this.dir=r.dir,this.cacheItemsPositions(),this.dir||(this.dir=v?v.getAttribute("dir"):"ltr",this.dir=this.dir==="rtl"?-1:1),this.currentItem=r.currentItem||parseInt(i.getAttribute("data-currentItem"),10)||u&&w.indexOf(u.one("."+d)),this.currentItem<0&&(this.currentItem=0),x&&x.touch&&(s=i.getDOMNode(),N=(new Stencil.Swiper(i,{config:{swipe:{acceptable_opposite_axis_movement:300,min_swipe_distance:10}}})).captureTouch(),s.addEventListener(h,e.bind(this.swipe,this),!1),s.addEventListener(l,e.bind(this.swipe,this),!1),s.addEventListener(c,e.bind(this.swipe,this),!1),s.addEventListener(a,e.bind(this.swipe,this),!1),s.addEventListener(f,e.bind(this.swipe,this),!1),s.addEventListener("tap",function(e){},!1));if(!this.node||!this.sliderEl||!this.maskEl||!this.itemsEl.size())return;o&&this.updateIndicators(),this.updateToolbar(),i.once("mouseover",this.loadDelayedImages,this),this.resizeHandle=e.on(t+":resize",this.onResize,this)}var n=null,r=!0,i=!1,s="prev",o="next",u="jump-to",a="swipe",f="slide",l="init",c="end",h="dragstart",p=".Gallery-",d="Selected",v="Active",m=p+"Item",g=p+"Slider",y=p+"Indicator",b=p+"Mask",w="Disabled",E="button[data-jump-to=prev]",S="button[data-jump-to=next]",x=Modernizr,T=e.one("body"),N="disabled",C;e.one(e.config.win).on("resize",function(){clearTimeout(C),C=setTimeout(function(){e.fire(t+":resize")},100)},this),e.extend(k,e.Stencil.BasePlugin,{currentItem:0,itemsLength:0,itemsPositions:[],itemsWidths:[],currentWidth:0,totalWidth:0,isDelayedLoaded:i,destroy:function(){this.node=n,this.sliderEl=n,this.maskEl=n,this.itemsEl=n,this.indicatorsEl=n,this.itemsPositions=n,this.prevEl=n,this.nextEl=n,this.resizeHandle&&(this.resizeHandle.detach(),this.resizeHandle=n),this.constructor.superclass.destroy.apply(this,arguments)},loadDelayedImages:function(){T.fire("imageloader:delayed",this.node),this.isDelayedLoaded=r},cacheItemsPositions:function(){var e=[0],t=[],n=0;this.itemsEl.each(function(r,i){var s=r.get("children").item(0),o;i!==0&&e.push(e[i-1]+t[i-1]),s&&s.get("tagName").toUpperCase()==="IMG"?o=parseInt(s.get("width"),10):o=parseInt(s.get("offsetWidth"),10),t.push(o),n+=o},this),this.totalWidth=n,this.itemsWidths=t,this.itemsPositions=e},jumpTo:function(e,t){var n=this.currentWidth,r=this.currentItem,u=this.itemsLength,a=this.itemsWidths,f=this.itemsPositions,l=this.totalWidth,c=0;e=typeof e=="number"||typeof e=="string"?e:r,t=t||"slide";if(e===s){while(r!==0&&f[r-1]>l-n)r-=1;if(r!==0)do r-=1,c+=a[r];while(r!==0&&c+a[r-1]<n)}else if(e===o){if(r+1!==u)do c+=a[r],r+=1;while(r+1!==u&&c+a[r+1]<n)}else r=parseInt(e,10);r!==0&&f[r]+n>=l&&(r=u-1),this.currentItem=r,t==="slide"?this.slide(r):t==="none"&&this.translate(this.sliderEl,-this.itemsPositions[e],0,i),this.updateToolbar(),this.updateIndicators()},slide:function(e){this.translate(this.sliderEl,-this.itemsPositions[e],0)},translate:function(e,t,n,r){var s={},o=this.dir;return t=t?Math.max(t,this.currentWidth-this.totalWidth):t,t=t||t===0?o*t+"px":"",n=n||n===0?o*n+"px":"",x&&x.csstransforms3d?s.transform=t||n?"translate3d("+t+","+n+",0)":"":(s.left=t,s.top=n),r===i||!t&&!n&&!r?(e.setStyles(s),"notransition"):(s.duration=.4,e.transition(s,r),"transition")},handleEvent:function(e){var t=e.target.ancestor("[data-"+u+"]",r);t&&!t.get("disabled")&&t.getData(u)&&(this.jumpTo(t.getData(u)),e.preventDefault())},onResize:function(){var e=this.currentItem,t=this.maskEl.get("offsetWidth"),n=this.totalWidth;this.currentWidth=t,e!==0&&(n<=t?this.jumpTo(0,"none"):this.itemsPositions[e]+t>=n&&this.jumpTo(this.itemsLength-1,"none")),this.updateToolbar()},swipe:function(e){var t=0,n=this.sliderEl,r=this.itemsLength,u=this.currentItem;switch(e.type){case h:e.preventDefault();break;case l:this.loadDelayedImages();break;case f:e.detail.delta.absx>30&&(t=e.detail.delta.x+this.itemsPositions[u],this.translate(n,-t,0,i));break;case c:this.jumpTo(u);break;default:e.detail.direction==="left"?this.jumpTo(o):this.jumpTo(s)}},updateIndicators:function(){var e=this.indicatorsEl;e&&(e.removeClass(v),e.item(this.currentItem).addClass(v))},updateToolbar:function(){var e=this.currentItem,t=this.currentWidth,n=this.totalWidth,r=this.prevEl,i=this.nextEl;r&&i&&(e+1===this.itemsLength||n<=t?(i.setAttribute(N,N),i.addClass(w)):(i.removeAttribute(N,N),i.removeClass(w)),e===0||n<=t?(r.setAttribute(N,N),r.addClass(w)):(r.removeAttribute(N,N),r.removeClass(w)))}},{NS:"StencilGallery",CSS_SELECTED:d,CSS_ACTIVE:v,CSS_ITEM:m,CSS_SLIDER:g,CSS_INDICATORS:y,CSS_MASK:b,CSS_DISABLED:w,PREV_SELECTOR:E,NEXT_SELECTOR:S,requiresInit:!0}),e.Stencil.registerPlugin(k,"Gallery")},"@VERSION@",{requires:["stencil-base","yui-base","dom-base","node-base","node-style","node-pluginhost","transition"]});
YUI.add("flickr-collection",function(e){"use strict";e.namespace("Flickr").Collection=e.Base.create("FlickrCollection",e.Model,[],{idAttribute:"cat"},{ATTRS:{cat:{getter:function(){return this.get("category")}}}})},"@VERSION@",{requires:["model"]});
YUI.add("flickr-collections",function(e){"use strict";e.namespace("Flickr").Collections=e.Base.create("FlickrCollections",e.ModelList,[e.Af.Sync],{resource:"flickr",readonly:!0,idAttribute:"categories",model:e.Flickr.Collection},{ATTRS:{categories:{getter:function(){return this.get("category")}}}})},"@VERSION@",{requires:["model-list","af-sync","flickr-collection"]});
YUI.add("td-applet-flickr-model",function(e){"use strict";e.namespace("TD.Applet").FlickrModel=e.Base.create("TDAppletFlickrModel",e.Mjata.Model,[e.Af.Sync],{resource:"flickr",readonly:!0,idAttribute:"categories",collections:undefined,initializer:function(){this.collections=new e.Flickr.Collections({model:e.Flickr.Collection})}},{ATTRS:{collections:{getter:function(){return this.collections},setter:function(e){var t;return this.collections.reset(e),t=this.collections.item(0),this.selected=t?t.get(t.idAttribute):undefined,e}},categories:{getter:function(){return this.get("collections").get("category")}}}})},"@VERSION@",{requires:["mjata-model","flickr-collections","af-sync"]});
YUI.add("td-applet-flickr-mainview",function(e){e.namespace("TD.Applet").FlickrMainView=e.Base.create("TDAppletFlickrMainView",e.Af.AppletView,[],{initializer:function(){var e=this.get("model");e.after("settingsChange",function(){this.forceRender()},this)}})},"@VERSION@",{requires:["node","af-applet-view","stencil","stencil-bquery"]});
YUI.add("td-applet-flickr-templates-main",function(e,t){dust.cache=dust.cache||{},dust.cache[t]=function(){return function(){function e(e,n){return e.write('<div id="').reference(n.get("instance_id"),n,"h").write('">').write("\n    ").section(n.getPath(!1,["data","flickr","collections"]),n,{block:t},{ctab:n.getPath(!1,["user_settings","ctab"]),grpt:n.getPath(!1,["config","grptMap",n.getPath(!1,["user_settings","ctab"])])}).write("\n").write("</div>").write("\n")}function t(e,t){return e.write("\n    ").helper("eq",t,{block:n},{key:t.get("ctab"),value:t.get("category")}).write("\n    ")}function n(e,t){return e.write("\n    ").write('<div class="Pos-r" data-plugin="bquery">').write("\n        ").write('<p class="Fz-s Mt-0">').helper("i18n_string",t,{},{_key:"SEE_MORE"}).write('<a href="').reference(t.get("url"),t,"h").write('" ').helper("rapid_data_attr",t,{},{rspns:"nav",t1:"a4",t2:"app-flk",t3:"ct",sec:"app-flk",elm:"itm",elmt:"link",itc:"0",pkgt:"10img",grpt:t.get("grpt")}).write(">").reference(t.get("title"),t,"h").write("</a></p>").write("\n\n        ").write('<ul class="Grid W-100 SeparatedThumbs Reset ALaFlickr Bp-5-on-5">').write("\n          ").section(t.get("photos"),t,{block:r},null).write("\n        ").write("</ul>").write("\n    ").write("</div>").write("\n    ")}function r(e,t){return e.write("\n            ").write("<li class='Grid-U Box").helper("math",t,{},{key:i,method:"add",operand:"1"}).write("'>").write("\n                ").write("<a ").helper("rapid_data_attr",t,{},{rspns:"nav",t1:"a4",t2:"app-flk",t3:"ct",sec:"app-flk",elm:"img",elmt:"ct",itc:"0",pkgt:"10img",grpt:t.get("grpt")}).write(' href="').reference(t.get("url"),t,"h").write('lightbox" >').write("\n                    ").helper("img",t,{},{src:s,title:o,width:"75",height:"75"}).write("\n                ").write("</a>").write("\n            ").write("</li>").write("\n          ")}function i(e,t){return e.reference(t.get("$idx"),t,"h")}function s(e,t){return e.reference(t.get("img_src"),t,"h")}function o(e,t){return e.reference(t.get("title"),t,"h")}return dust.register("td-applet-flickr-templates-main",e),e}()}(),dust.cache["td-applet-flickr:main.dust"]=dust.cache["td-applet-flickr:main"]=dust.cache[t],e.Template._cache=e.Template._cache||{},e.Template._cache["td-applet-flickr/templates/main"]=function(e,n){e=e||{},dust.render(t,e,n)}},"@VERSION@",{requires:["template-base","dust"]});
